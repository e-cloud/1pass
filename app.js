!function(){'use strict';var e={version:'0.4.0',domain:'',passLenRange:new Array(123).fill(0).map(function(e,t){return t+6}),passOutLen:16,charset:94,itCount:100,salt:'I am a dummy salt. Do not use me.'};'undefined'!=typeof window?window:'undefined'!=typeof global?global:'undefined'!=typeof self&&self;var t,r=(function(e,t){!function(t){function r(e,t,r){var n,h,c,d,v,b,g,w,A,E=0,C=[],m=0,k=!1,y=[],T=[],B=!1,L=!1,M=-1;if(n=(r=r||{}).encoding||'UTF8',(A=r.numRounds||1)!==parseInt(A,10)||1>A)throw Error('numRounds must a integer >= 1');if(0!==e.lastIndexOf('SHA3-',0)&&0!==e.lastIndexOf('SHAKE',0))throw Error('Chosen SHA variant is not supported');var H=6;if(b=p,w=function(e){var t,r=[];for(t=0;5>t;t+=1)r[t]=e[t].slice();return r},M=1,'SHA3-224'===e)v=1152,d=224;else if('SHA3-256'===e)v=1088,d=256;else if('SHA3-384'===e)v=832,d=384;else if('SHA3-512'===e)v=576,d=512;else if('SHAKE128'===e)v=1344,d=-1,H=31,L=!0;else{if('SHAKE256'!==e)throw Error('Chosen SHA variant is not supported');v=1088,d=-1,H=31,L=!0}g=function(e,t,r,n,o){var a,i=H,s=[],u=(r=v)>>>5,f=0,h=t>>>5;for(a=0;a<h&&t>=r;a+=u)n=p(e.slice(a,a+u),n),t-=r;for(e=e.slice(a),t%=r;e.length<u;)e.push(0);for(e[(a=t>>>3)>>2]^=i<<a%4*8,e[u-1]^=2147483648,n=p(e,n);32*s.length<o&&(e=n[f%5][f/5|0],s.push(e.b),!(32*s.length>=o));)s.push(e.a),0==64*(f+=1)%r&&p(null,n);return s},c=f(t,n,M),h=l(e),this.setHMACKey=function(t,r,o){var a;if(!0===k)throw Error('HMAC key already set');if(!0===B)throw Error('Cannot set HMAC key after calling update');if(!0===L)throw Error('SHAKE is not supported for HMAC');if(t=(r=f(r,n=(o||{}).encoding||'UTF8',M)(t)).binLen,r=r.value,o=(a=v>>>3)/4-1,a<t/8){for(r=g(r,t,0,l(e),d);r.length<=o;)r.push(0);r[o]&=4294967040}else if(a>t/8){for(;r.length<=o;)r.push(0);r[o]&=4294967040}for(t=0;t<=o;t+=1)y[t]=909522486^r[t],T[t]=1549556828^r[t];h=b(y,h),E=v,k=!0},this.update=function(e){var t,r,n,o=0,a=v>>>5;for(e=(t=c(e,C,m)).binLen,r=t.value,t=e>>>5,n=0;n<t;n+=a)o+v<=e&&(h=b(r.slice(n,n+a),h),o+=v);E+=o,C=r.slice(o>>>5),m=e%v,B=!0},this.getHash=function(t,r){var n,f,c,p;if(!0===k)throw Error('Cannot call getHash after setting HMAC key');if(c=u(r),!0===L){if(-1===c.shakeLen)throw Error('shakeLen must be specified in options');d=c.shakeLen}switch(t){case'HEX':n=function(e){return o(e,d,M,c)};break;case'B64':n=function(e){return a(e,d,M,c)};break;case'BYTES':n=function(e){return i(e,d,M)};break;case'ARRAYBUFFER':try{f=new ArrayBuffer(0)}catch(e){throw Error('ARRAYBUFFER not supported by this environment')}n=function(e){return s(e,d,M)};break;default:throw Error('format must be HEX, B64, BYTES, or ARRAYBUFFER')}for(p=g(C.slice(),m,E,w(h),d),f=1;f<A;f+=1)!0===L&&0!=d%32&&(p[p.length-1]&=16777215>>>24-d%32),p=g(p,d,0,l(e),d);return n(p)},this.getHMAC=function(t,r){var n,f,c,p;if(!1===k)throw Error('Cannot call getHMAC without first setting HMAC key');switch(c=u(r),t){case'HEX':n=function(e){return o(e,d,M,c)};break;case'B64':n=function(e){return a(e,d,M,c)};break;case'BYTES':n=function(e){return i(e,d,M)};break;case'ARRAYBUFFER':try{n=new ArrayBuffer(0)}catch(e){throw Error('ARRAYBUFFER not supported by this environment')}n=function(e){return s(e,d,M)};break;default:throw Error('outputFormat must be HEX, B64, BYTES, or ARRAYBUFFER')}return f=g(C.slice(),m,E,w(h),d),p=b(T,l(e)),n(p=g(f,d,v,p,d))}}function n(e,t){this.a=e,this.b=t}function o(e,t,r,n){var o,a,i,s='';for(t/=8,i=-1===r?3:0,o=0;o<t;o+=1)a=e[o>>>2]>>>8*(i+o%4*r),s+='0123456789abcdef'.charAt(a>>>4&15)+'0123456789abcdef'.charAt(15&a);return n.outputUpper?s.toUpperCase():s}function a(e,t,r,n){var o,a,i,s,u='',f=t/8;for(s=-1===r?3:0,o=0;o<f;o+=3)for(a=o+1<f?e[o+1>>>2]:0,i=o+2<f?e[o+2>>>2]:0,i=(e[o>>>2]>>>8*(s+o%4*r)&255)<<16|(a>>>8*(s+(o+1)%4*r)&255)<<8|i>>>8*(s+(o+2)%4*r)&255,a=0;4>a;a+=1)u+=8*o+6*a<=t?'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'.charAt(i>>>6*(3-a)&63):n.b64Pad;return u}function i(e,t,r){var n,o,a,i='';for(t/=8,a=-1===r?3:0,n=0;n<t;n+=1)o=e[n>>>2]>>>8*(a+n%4*r)&255,i+=String.fromCharCode(o);return i}function s(e,t,r){t/=8;var n,o,a,i=new ArrayBuffer(t);for(a=new Uint8Array(i),o=-1===r?3:0,n=0;n<t;n+=1)a[n]=e[n>>>2]>>>8*(o+n%4*r)&255;return i}function u(e){var t={outputUpper:!1,b64Pad:'=',shakeLen:-1};if(e=e||{},t.outputUpper=e.outputUpper||!1,!0===e.hasOwnProperty('b64Pad')&&(t.b64Pad=e.b64Pad),!0===e.hasOwnProperty('shakeLen')){if(0!=e.shakeLen%8)throw Error('shakeLen must be a multiple of 8');t.shakeLen=e.shakeLen}if('boolean'!=typeof t.outputUpper)throw Error('Invalid outputUpper formatting option');if('string'!=typeof t.b64Pad)throw Error('Invalid b64Pad formatting option');return t}function f(e,t,r){switch(t){case'UTF8':case'UTF16BE':case'UTF16LE':break;default:throw Error('encoding must be UTF8, UTF16BE, or UTF16LE')}switch(e){case'HEX':e=function(e,t,n){var o,a,i,s,u,f,h=e.length;if(0!=h%2)throw Error('String of HEX type must be in byte increments');for(t=t||[0],u=(n=n||0)>>>3,f=-1===r?3:0,o=0;o<h;o+=2){if(a=parseInt(e.substr(o,2),16),isNaN(a))throw Error('String of HEX type contains invalid characters');for(i=(s=(o>>>1)+u)>>>2;t.length<=i;)t.push(0);t[i]|=a<<8*(f+s%4*r)}return{value:t,binLen:4*h+n}};break;case'TEXT':e=function(e,n,o){var a,i,s,u,f,h,c,l,p=0;if(n=n||[0],f=(o=o||0)>>>3,'UTF8'===t)for(l=-1===r?3:0,s=0;s<e.length;s+=1)for(i=[],128>(a=e.charCodeAt(s))?i.push(a):2048>a?(i.push(192|a>>>6),i.push(128|63&a)):55296>a||57344<=a?i.push(224|a>>>12,128|a>>>6&63,128|63&a):(s+=1,a=65536+((1023&a)<<10|1023&e.charCodeAt(s)),i.push(240|a>>>18,128|a>>>12&63,128|a>>>6&63,128|63&a)),u=0;u<i.length;u+=1){for(h=(c=p+f)>>>2;n.length<=h;)n.push(0);n[h]|=i[u]<<8*(l+c%4*r),p+=1}else if('UTF16BE'===t||'UTF16LE'===t)for(l=-1===r?2:0,i='UTF16LE'===t&&1!==r||'UTF16LE'!==t&&1===r,s=0;s<e.length;s+=1){for(a=e.charCodeAt(s),!0===i&&(a=(u=255&a)<<8|a>>>8),h=(c=p+f)>>>2;n.length<=h;)n.push(0);n[h]|=a<<8*(l+c%4*r),p+=2}return{value:n,binLen:8*p+o}};break;case'B64':e=function(e,t,n){var o,a,i,s,u,f,h,c,l=0;if(-1===e.search(/^[a-zA-Z0-9=+\/]+$/))throw Error('Invalid character in base-64 string');if(a=e.indexOf('='),e=e.replace(/\=/g,''),-1!==a&&a<e.length)throw Error('Invalid \'=\' found in base-64 string');for(t=t||[0],f=(n=n||0)>>>3,c=-1===r?3:0,a=0;a<e.length;a+=4){for(u=e.substr(a,4),i=s=0;i<u.length;i+=1)s|=(o='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'.indexOf(u[i]))<<18-6*i;for(i=0;i<u.length-1;i+=1){for(o=(h=l+f)>>>2;t.length<=o;)t.push(0);t[o]|=(s>>>16-8*i&255)<<8*(c+h%4*r),l+=1}}return{value:t,binLen:8*l+n}};break;case'BYTES':e=function(e,t,n){var o,a,i,s,u,f;for(t=t||[0],i=(n=n||0)>>>3,f=-1===r?3:0,a=0;a<e.length;a+=1)o=e.charCodeAt(a),s=(u=a+i)>>>2,t.length<=s&&t.push(0),t[s]|=o<<8*(f+u%4*r);return{value:t,binLen:8*e.length+n}};break;case'ARRAYBUFFER':try{e=new ArrayBuffer(0)}catch(e){throw Error('ARRAYBUFFER not supported by this environment')}e=function(e,t,n){var o,a,i,s,u,f;for(t=t||[0],a=(n=n||0)>>>3,u=-1===r?3:0,f=new Uint8Array(e),o=0;o<e.byteLength;o+=1)i=(s=o+a)>>>2,t.length<=i&&t.push(0),t[i]|=f[o]<<8*(u+s%4*r);return{value:t,binLen:8*e.byteLength+n}};break;default:throw Error('format must be HEX, TEXT, B64, BYTES, or ARRAYBUFFER')}return e}function h(e,t){return 32<t?(t-=32,new n(e.b<<t|e.a>>>32-t,e.a<<t|e.b>>>32-t)):0!==t?new n(e.a<<t|e.b>>>32-t,e.b<<t|e.a>>>32-t):e}function c(e,t){return new n(e.a^t.a,e.b^t.b)}function l(e){var t=[];if(0!==e.lastIndexOf('SHA3-',0)&&0!==e.lastIndexOf('SHAKE',0))throw Error('No SHA variants supported');for(e=0;5>e;e+=1)t[e]=[new n(0,0),new n(0,0),new n(0,0),new n(0,0),new n(0,0)];return t}function p(e,t){var r,o,a,i,s=[],u=[];if(null!==e)for(o=0;o<e.length;o+=2)t[(o>>>1)%5][(o>>>1)/5|0]=c(t[(o>>>1)%5][(o>>>1)/5|0],new n(e[o+1],e[o]));for(r=0;24>r;r+=1){for(i=l('SHA3-'),o=0;5>o;o+=1){a=t[o][0];var f=t[o][1],p=t[o][2],b=t[o][3],g=t[o][4];s[o]=new n(a.a^f.a^p.a^b.a^g.a,a.b^f.b^p.b^b.b^g.b)}for(o=0;5>o;o+=1)u[o]=c(s[(o+4)%5],h(s[(o+1)%5],1));for(o=0;5>o;o+=1)for(a=0;5>a;a+=1)t[o][a]=c(t[o][a],u[o]);for(o=0;5>o;o+=1)for(a=0;5>a;a+=1)i[a][(2*o+3*a)%5]=h(t[o][a],d[o][a]);for(o=0;5>o;o+=1)for(a=0;5>a;a+=1)t[o][a]=c(i[o][a],new n(~i[(o+1)%5][a].a&i[(o+2)%5][a].a,~i[(o+1)%5][a].b&i[(o+2)%5][a].b));t[0][0]=c(t[0][0],v[r])}return t}var d,v;v=[new n(0,1),new n(0,32898),new n(2147483648,32906),new n(2147483648,2147516416),new n(0,32907),new n(0,2147483649),new n(2147483648,2147516545),new n(2147483648,32777),new n(0,138),new n(0,136),new n(0,2147516425),new n(0,2147483658),new n(0,2147516555),new n(2147483648,139),new n(2147483648,32905),new n(2147483648,32771),new n(2147483648,32770),new n(2147483648,128),new n(0,32778),new n(2147483648,2147483658),new n(2147483648,2147516545),new n(2147483648,32896),new n(0,2147483649),new n(2147483648,2147516424)],d=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]],e.exports&&(e.exports=r),r}()}(t={exports:{}},t.exports),t.exports),n='0123456789',o='abcdefghijklmnopqrstuvwxyz',a='ABCDEFGHIJKLMNOPQRSTUVWXYZ';for(var i=[],s=0;s<8;s++)i[s]=Math.pow(2,s+1)-1;function u(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=0,o=0,a=function(e,t){return Math.floor(Math.log(e)/Math.log(t))}(e,r),i=Math.log(r)/Math.log(e),s=0,u=a;u<=t;u++){var f=Math.ceil(u*i),h=u/f;h>s&&(s=h,n=u,o=f)}return{bitsCount:n,charsCountInBits:o}}var f=function(e,t){if(!(e instanceof t))throw new TypeError('Cannot call a class as a function')},h=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,'value'in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64;f(this,e),this.alphabet=t,this.alphabetLen=t.length,this.blockMaxBitsCount=r;var n=u(this.alphabetLen,this.blockMaxBitsCount,2);this.blockBitsCount=n.bitsCount,this.blockCharsCount=n.charsCountInBits,this.powN=function(e,t){for(var r=[],n=0,o=1;n<t;n++,o*=e)r[n]=o;return r}(this.alphabetLen,this.blockCharsCount),this.inverseAlphabet={};for(var o=0;o<this.alphabetLen;o++)this.inverseAlphabet[this.alphabet[o]]=o}return h(e,[{key:'encodeString',value:function(e){return this.encodeBytes(function(e){for(var t=[],r=0;r<e.length;r++){var n=e.charCodeAt(r);n<128?t.push(n):n<2048?t.push(192|n>>6,128|63&n):n<55296||n>=57344?t.push(224|n>>12,128|n>>6&63,128|63&n):(r++,n=65536+((1023&n)<<10|1023&e.charCodeAt(r)),t.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n))}return t}(e))}},{key:'encodeBytes',value:function(e){if(!e||0===e.length)return'';for(var t=this.blockBitsCount,r=this.blockCharsCount,n=Math.floor(8*e.length/t)*t,o=8*e.length-n,a=Math.floor(n*r/t),i=Math.floor((o*r+t-1)/t),s=Math.floor(a/r),u=[],f=0;f<s;f++)this.encodeBlock(e,u,f,t,r);if(0!==o){var h=l(e,n,o);this.bitsToChars(u,a,i,h)}return u.join('')}},{key:'encodeBlock',value:function(e,t,r,n,o){var a=r*o,i=l(e,r*n,n);this.bitsToChars(t,a,o,i)}},{key:'bitsToChars',value:function(e,t,r,n){for(var o=n,a=0;a<r;a++)e[t+a]=this.alphabet[o%this.alphabetLen],o=Math.floor(o/this.alphabetLen)}},{key:'decodeToString',value:function(e){return function(e){var t=void 0,r=void 0,n=void 0,o=void 0,a='',i=e.length;for(t=0;t<i;)switch((r=e[t++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(r);break;case 12:case 13:n=e[t++],a+=String.fromCharCode((31&r)<<6|63&n);break;case 14:n=e[t++],o=e[t++],a+=String.fromCharCode((15&r)<<12|(63&n)<<6|(63&o)<<0)}return a}(this.decodeToBytes(e))}},{key:'decodeToBytes',value:function(e){if(!e||0===e.length)return[];var t=this.blockBitsCount,r=this.blockCharsCount,n=8*Math.floor((Math.floor((e.length-1)*t/r)+8)/8),o=Math.floor(n/t)*t,a=n-o,i=Math.floor(o*r/t),s=Math.floor((a*r+t-1)/t),u=this.charsToBits(e,i,s);a>=32||u>>a==0||(a=(n+=8)-(o=Math.floor(n/t)*t),i=Math.floor(o*r/t),s=Math.floor((a*r+t-1)/t));for(var f=Math.floor(i/r),h=[],c=0;c<f;c++)this.decodeBlock(e,h,c,t,r);0!==s&&p(h,this.charsToBits(e,i,s),o,a);return h}},{key:'decodeBlock',value:function(e,t,r,n,o){var a=r*o,i=r*n;p(t,this.charsToBits(e,a,o),i,n)}},{key:'charsToBits',value:function(e,t,r){for(var n=0,o=0;o<r;o++){n+=this.inverseAlphabet[e[t+o]]*this.powN[o]}return n}}]),e}();function l(e,t,r){var n=0,o=Math.floor(t/8),a=t%8,s=Math.min(r,8-a);if(0!==s){n=(e[o]>>8-s-a&i[7-a])<<r-s,o+=Math.floor((a+s)/8),a=(a+s)%8;var u=r-s;for(u>8&&(u=8);u>0;)s+=u,n|=e[o]>>8-u<<r-s,o+=Math.floor((a+u)/8),a=(a+u)%8,(u=r-s)>8&&(u=8)}return n}function p(e,t,r,n){var o=Math.floor(r/8),a=r%8,s=Math.min(n,8-a);if(0!==s){var u=n+a-8,f=u>=0?t>>u:t<<-u;f&=i[7-a],f&=255,e[o]|=f,o+=Math.floor((a+s)/8),a=(a+s)%8;var h=n-s;for(h>8&&(h=8);h>0;){var c=t>>n-(s+=h)<<8-h&255;e[o]|=c,o+=Math.floor((a+h)/8),a=(a+h)%8,(h=n-s)>8&&(h=8)}}}function d(e,t,r){var i=new c(function(e){switch(e){case 10:return n;case 62:return a+o+n;case 64:return a+o+n+'+/';case 94:return new Array(94).fill(0).map(function(e,t){return String.fromCharCode(t+33)}).join('')}}(r)).encodeString(e);return i.length<t&&window.alert('出问题了，请联系作者:)'),i.slice(0,t)}function v(e){return d(function(e,t){var n=new r('SHA3-512','TEXT');return n.setHMACKey(e,'TEXT'),n.update(t.domain$+'-'+t.username$+'_'+t.salt$),n.getHMAC('HEX')}(function(e){var t=new r('SHA3-512','TEXT',{numRounds:e.itCount$});return t.update(e.password$),t.getHash('HEX')}(e),e),e.passOutLen$,e.charset$)}var b,g=document,w=function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:g).querySelector(e)};function A(e){var t=g.querySelector('.onePassPanel');t.id='onepass-wrapper',t.innerHTML=function(e,t){var r=t.passLenRange.map(function(e){return'<option value="'+e+'" '+(t.passOutLen===e?'selected="true"':'')+'>'+e+'</option>'});return e.replace('$VERSION$',t.version).replace('$DOMAIN$',t.domain).replace('$IT_COUNT$',t.itCount).replace('$PASS_OUT_RANGE$',r)}(t.innerHTML,e),w('#salt',t).value=e.salt,function(e){var t=function(t){return w(t,e)};t('#toggler').addEventListener('click',function(e){var r=e.target,n=t('.optg'),o=n.getAttribute('hidden');null!==o?(n.removeAttribute('hidden'),r.textContent='−'):(n.setAttribute('hidden',''),r.textContent='+')}),t('#onePass').addEventListener('submit',function(e){e.preventDefault();var t=e.target.elements,r=v({domain$:t.domain.value,charset$:parseInt(t.charset.value),username$:t.name.value||'',password$:t.pass.value,passOutLen$:parseInt(t.passOutLen.value),itCount$:parseInt(t.itCount.value),salt$:t.salt.value||''});!function(e){w('#op_keygen').textContent=e;var t=w('.cg p[hidden]');t&&t.removeAttribute('hidden')}(r)}),t('#op_clean').addEventListener('click',function(){t('.cg p').setAttribute('hidden',''),t('#op_keygen').textContent=''}),t('a[title="close"]').addEventListener('click',function(){var e;(e=w('#onepass-wrapper'))&&e.parentNode.removeChild(e)});var r=null;t('#op_keygen').addEventListener('click',function(e){var n,o,a,i;n=e.target,o=void 0,a=void 0,i=document,window.getSelection?(a=window.getSelection(),(o=i.createRange()).selectNodeContents(n),a.removeAllRanges(),a.addRange(o)):i.body.createTextRange&&((o=i.body.createTextRange()).moveToElementText(n),o.select()),function(){try{document.execCommand('copy')}catch(e){return alert('please press Ctrl/Cmd+C to copy'),!1}return!0}()&&(t('#op_toastr').removeAttribute('hidden'),r&&clearTimeout(r),r=setTimeout(function(){t('#op_toastr').setAttribute('hidden',''),r=null},3e3))})}(t)}'serviceWorker'in navigator&&navigator.serviceWorker.register('./sw.js').then(function(){console.log('Service Worker Registered')}),(b=e).passOutLen=parseInt(b.passOutLen),A(b)}();
